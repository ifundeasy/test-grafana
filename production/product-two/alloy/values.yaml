replicaCount: 1

controller:
  type: deployment

alloy:
  configMap:
    create: true
    name: alloy-config
    content: |
      discovery.kubernetes "k8s" {
        role = "pod"

        namespaces {
          names = ["product-two"]
        }
      }

      loki.write "default" {
        endpoint {
          url     = "http://lk-loki-gateway.grafana.svc.cluster.local/loki/api/v1/push"
          headers = {
            "X-Scope-OrgID" = "product-two",
          }
        }
      }

      loki.source.kubernetes "pods" {
        targets    = discovery.kubernetes.k8s.targets
        forward_to = [loki.write.default.receiver]
      }

image:
  repository: grafana/alloy
  tag: latest
  pullPolicy: IfNotPresent

service:
  enabled: true
  ports:
    - name: http-metrics
      port: 12345
      targetPort: 12345

resources:
  limits:
    cpu: 200m
    memory: 256Mi
  requests:
    cpu: 100m
    memory: 128Mi
